'===========================================================
' LISTADO OFICIAL: headers requeridos en la hoja Base
' (deben existir sí o sí en el repositorio)
'===========================================================
Private Function RequiredHeaders_Base() As Variant
    Dim chunks As Variant

    chunks = Array( _
        "ID_INTERNO|CODIGO_TARIFA|POLIZA|SOCIO|PLAN|PRIMA_CLIENTE_NETA|UNIDAD_PRIMA_CLIENTE_NETA|COMISIONES|GASTOS_DIRECTOS|GASTOS_INDIRECTOS|VENTAS|MESES_DE_VENTA|DURACION_MEDIA_MESES|TASA_DE_ENTRADA|SINIESTRO_MEDIO|UNIDAD_SINIESTRO_MEDIO|SINIESTRALIDAD|DEVOLUCIONES|CUOTAS_PROMEDIO|VALOR_CLIENTE|ASISTENCIA_MENSUAL|UNIDAD_ASISTENCIA_MENSUAL|ASISTENCIA_VENTA|UNIDAD_ASISTENCIA_VENTA", _
        "COSTOS_MENSUALES|UNIDAD_COSTOS_MENSUALES|COSTOS_VENTA|UNIDAD_COSTOS_VENTA|OTROS_COSTOS_DIRECTOS_FIJOS|UNIDAD_OTROS_COSTOS_DIRECTOS_FIJOS|CUT_OFF_RUN_OFF|FECHA_CUT_OFF|INFLACION|PROFIT_SHARING|PORCENTAJE_PROFIT_SHARING|REASEGURO|PRIMA_CEDIDA|SINIESTRO_CEDIDO|FORMULA_SINIESTRALIDAD_APLICA|BRIM|KPI_BRIM|UF|FECHA_FIN_TARIFA|OBSERVACIÓN|PLAN_DE_ACCIÓN", _
        "PRODUCTO_CUENTA_CON_ASISTENCIA_SI_NO|%_DE_DESCUENTO_ASISTENCIA_(CÁLCULO_LOADINGS)|RATIO_DE_ASISTENCIA_SOBRE_LA_NEP|SINIESTRALIDAD_SOBRE_LA_NEP|%_DE_COMISIÓN_BRUTA_SOBRE_PRIMA_BRUTA|IVA_EFECTIVO|IVA_RECUPERABLE|GASTOS_DIRECTOS_/_NEP|GASTOS_INDIRECTOS_/_NEP", _
        "TIENE_ECOSISTEMA_(SI/NO)|CANAL_TMK_(SI/NO)|ROP_(SI/NO)|BONIFICACION_ROP_(%)|VENTA_POR_PLANES_(SI/NO)|PRIMA_PROMEDIO_DE_VENTA_UNICA_(SI_ES_DISTINTA_POR_PLAN_ESPECIFICAR)|OTROS_COSTOS_EJEMPLO_COSTO_POR_VENTA_UNICA_(SI_ES_DISTINTA_POR_PLAN_ESPECIFICAR)|RIESGOS_COBERTURA_(ESPECIFICAR_QUE_RIESGO_CUBRE)", _
        "CAPITAL_ASEGURADO_(UF_O_COMENTARIO_EJ_SALDO_INSOLUTO)_(ESPECIFICAR_POR_CADA_RIESGO)|SINIESTRO_MEDIO_(UF_O_CLP)_(ESPECIFICAR_POR_CADA_RIESGO)|TASA_ENTRADA_(ESPECIFICAR_POR_CADA_RIESGO)|MESES_GRATIS/CARENCIA|PRODUCT_TYPE|POLIZA_ES_CONTINUACION_(SI/NO_ESPECIFICAR_NUMERO_DE_POLIZA)|PERIODICIDAD_(MENSUAL/UNICA)" _
    )

    RequiredHeaders_Base = HeadersFromChunks(chunks, "|")
End Function

'Construye un array 0..N-1 a partir de "chunks" separados por delimitador.
Private Function HeadersFromChunks(ByVal chunks As Variant, ByVal delim As String) As Variant
    Dim i As Long, j As Long
    Dim parts As Variant
    Dim tmp() As String
    Dim n As Long

    n = 0
    For i = LBound(chunks) To UBound(chunks)
        parts = Split(CStr(chunks(i)), delim)
        n = n + (UBound(parts) - LBound(parts) + 1)
    Next i

    ReDim tmp(0 To n - 1)

    n = 0
    For i = LBound(chunks) To UBound(chunks)
        parts = Split(CStr(chunks(i)), delim)
        For j = LBound(parts) To UBound(parts)
            tmp(n) = CStr(parts(j))
            n = n + 1
        Next j
    Next i

    HeadersFromChunks = tmp
End Function
